<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>URT Recon Report - {{ target }}</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 2rem;
            background: #f5f7fa;
            color: #222;
        }
        h1, h2 {
            color: #0074d9;
        }
        .status-ok { color: #28a745; }
        .status-error { color: #c00; }
        .status-skipped { color: #b8860b; }
        .section { margin-bottom: 2rem; }
        table {
            border-collapse: collapse;
            background: #fff;
            box-shadow: 0 2px 8px #ddd;
            width: 100%;
        }
        th, td {
            border: 1px solid #e1e1e1;
            padding: 8px 12px;
            text-align: left;
        }
        th {
            background: #f2f8fa;
        }
        .subtle { color: #888; font-size: 0.97em; }
        .module-status { font-weight: normal; font-size: 0.99em; }
    </style>
</head>
<body>
    <h1>Unified Recon Tool Report</h1>
    <div class="subtle">Scanned target: <b>{{ target }}</b> &mdash; Generated at {{ now() if now is defined else '' }}</div>
    <hr/>
    {% for module, res in results.items() %}
    <div class="section">
        <h2>{{ module | capitalize }}</h2>
        <span class="module-status 
            {% if res.status is defined and res.status.startswith('ok') %}status-ok
            {% elif res.status is defined and res.status.startswith('skip') %}status-skipped
            {% else %}status-error{% endif %}">
            {{ res.status if res.status is defined else 'ok' }}
        </span>
        <br/>
        {% if module == 'dns' and res.get('A') %}
            <b>A records:</b> <code>{{ res['A'] }}</code><br/>
            <b>MX:</b> <code>{{ res['MX'] }}</code><br/>
            <b>NS:</b> <code>{{ res['NS'] }}</code>
            {% if res.get('AXFR') %}
                <br/><b>AXFR attempts:</b>
                <ul>
                {% for z in res['AXFR'] %}
                    <li>{{ z.server }}: {{ 'Success' if z.zone else 'Failed: ' ~ z.error }}</li>
                {% endfor %}
                </ul>
            {% endif %}
        {% elif module == 'whois' and res.get('registrar') %}
            <table>
                <tr><th>Registrar</th><th>Created</th><th>Expires</th><th>Domain Age (days)</th></tr>
                <tr><td>{{ res.registrar }}</td><td>{{ res.creation_date }}</td><td>{{ res.expiration_date }}</td><td>{{ res.domain_age_days }}</td></tr>
            </table>
        {% elif module == 'http' and res.get('headers') %}
            <b>Headers</b><pre>{{ res.headers | tojson(indent=2) }}</pre>
            <b>Redirects</b>: <code>{{ res.redirects }}</code><br/>
            <b>Cookies</b>: <pre>{{ res.cookies | tojson(indent=2) }}</pre>
        {% elif module == 'tls' and res.get('CN') %}
            <table>
                <tr><th>CN</th><th>Issuer</th><th>SAN</th><th>Days till Expiry</th></tr>
                <tr><td>{{ res.CN }}</td><td>{{ res.issuer }}</td><td>{{ res.SAN | join(', ') }}</td><td>{{ res.days_until_expiry }}</td></tr>
            </table>
        {% elif module == 'nmap' and res.get('ports') %}
            <table>
                <tr><th>Port</th><th>Proto</th><th>Service</th><th>Status</th></tr>
                {% for port in res.ports %}
                <tr><td>{{ port.port }}</td><td>{{ port.protocol }}</td><td>{{ port.service }}</td><td>{{ port.state }}</td></tr>
                {% endfor %}
            </table>
        {% elif module == 'gobuster' and res.get('found') %}
            <b>Directories/Files Found:</b>
            <ul>
                {% for path in res.found %}
                    <li>{{ path }}</li>
                {% endfor %}
            </ul>
        {% elif module == 'nikto' and res.get('findings') %}
            <b>Nikto Findings ({{ res.count }})</b>
            <ul>{% for f in res.findings %}<li>{{ f }}</li>{% endfor %}</ul>
        {% elif module == 'whatweb' and res.get('plugins') %}
            <b>Detected Plugins/Technologies ({{ res.count }}):</b> {{ res.plugins | join(', ') }}
        {% else %}
            <pre>{{ res | tojson(indent=2) }}</pre>
        {% endif %}
    </div>
    {% endfor %}
    <hr/>
    <div class="subtle">Generated by URT | <a href="https://github.com/">https://github.com/</a></div>
</body>
</html>
